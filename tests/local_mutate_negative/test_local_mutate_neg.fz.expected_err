
--CURDIR--/test_local_mutate_neg.fz:65:9: warning 1: Loop instance escapes.
        for e in l do
--------^^^^^^^^^^^^^
          s.update a->a+e
^^^^^^^^^^^^^^^^^^^^^^^^^
Call that triggers the escape: 
--CURDIR--/test_local_mutate_neg.fz:65:9:
        for e in l do
--------^
The found escape route: 
--CURDIR--/test_local_mutate_neg.fz:65:9:
        for e in l do
--------^--CURDIR--/test_local_mutate_neg.fz:65:9:
        for e in l do
--------^^^^^^^^^^^^^
          s.update a->a+e
^^^^^^^^^^^^^^^^^^^^^^^^^
To solve this, either change the code where loop instance escapes or wrap loop in effect loop_allow_escape.


--CURDIR--/test_local_mutate_neg.fz:52:9: warning 2: Loop instance escapes.
        for e in l do
--------^^^^^^^^^^^^^
          # add e to s
^^^^^^^^^^^^^^^^^^^^^^
          s.update a->a+e
^^^^^^^^^^^^^^^^^^^^^^^^^
Call that triggers the escape: 
--CURDIR--/test_local_mutate_neg.fz:52:9:
        for e in l do
--------^
The found escape route: 
--CURDIR--/test_local_mutate_neg.fz:52:9:
        for e in l do
--------^--CURDIR--/test_local_mutate_neg.fz:52:9:
        for e in l do
--------^^^^^^^^^^^^^
          # add e to s
^^^^^^^^^^^^^^^^^^^^^^
          s.update a->a+e
^^^^^^^^^^^^^^^^^^^^^^^^^
To solve this, either change the code where loop instance escapes or wrap loop in effect loop_allow_escape.


--CURDIR--/test_local_mutate_neg.fz:50:14: error 1: Failed to verify that effect 'test_local_mutate_neg.test_sum.sum#1.m' is installed in current environment.
        s := m.env.new 0
-------------^^^^^
Callchain that lead to this point:

effect environment '--empty--' for call to 'test_local_mutate_neg.test_sum.sum#1.count' at --CURDIR--/test_local_mutate_neg.fz:79:11:
      say count    # *** will cause compile-time an error, requires m to be installed
----------^^^^^
effect environment '--empty--' for call to 'test_local_mutate_neg.test_sum.sum#1' at --CURDIR--/test_local_mutate_neg.fz:114:5:
    sum l0
----^^^
effect environment '--empty--' for call to 'test_local_mutate_neg.test_sum' at --CURDIR--/test_local_mutate_neg.fz:116:3:
  test_sum
--^^^^^^^^
effect environment '--empty--' for call to 'test_local_mutate_neg'
effect environment '--empty--' at program entry

one error and 2 warnings.

# This file is part of the Fuzion language implementation.
#
# The Fuzion language implementation is free software: you can redistribute it
# and/or modify it under the terms of the GNU General Public License as published
# by the Free Software Foundation, version 3 of the License.
#
# The Fuzion language implementation is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License along with The
# Fuzion language implementation.  If not, see <https://www.gnu.org/licenses/>.


# -----------------------------------------------------------------------
#
#  Tokiwa Software GmbH, Germany
#
#  Source code of Fuzion terminal module feature terminal
#
#  Author: Fridtjof Siebert (siebert@tokiwa.software)
#
# -----------------------------------------------------------------------

# terminal -- unit type feature providing ANSI terminal control codes
#
# Terminal provides constants to modify the text output style and color.
#
# Thanks to Bruno Penteado who collected these codes at
#
#   https://gist.github.com/bcap/5682077#file-terminal-control-sh
#
# but this also includes input from
#
#   https://en.wikipedia.org/wiki/ANSI_escape_code
#
# and
#
#   man console_codes
#
pub terminal is

  # control sequence introducer
  #
  pub csi => (String.type.from_bytes [u8 0o033]) + "[";

  # raw codes not surrounded by 'csi' and "m"
  #
  pub raw is
    pub reset                             => "0"
    pub bold                              => "1"
    pub dime                              => "2"
    pub italic                            => "3"
    pub underline                         => "4"
    pub slow_blink                        => "5"
    pub rapid_blink                       => "6"
    pub reverse                           => "7"
    pub crossed_out                       => "8"
    pub font_0                            => "10"
    pub font_1                            => "11"
    pub font_2                            => "12"
    pub font_3                            => "13"
    pub font_4                            => "14"
    pub font_5                            => "15"
    pub font_6                            => "16"
    pub font_7                            => "17"
    pub font_8                            => "18"
    pub font_9                            => "19"
    pub fraktur                           => "20"
    pub double_underline                  => "21"
    pub normal_intensity                  => "22"
    pub neither_italic_nor_blackletter    => "23"
    pub not_underlined                    => "24"
    pub not_blinking                      => "25"
    pub proportional_spacing              => "26"
    pub not_reversed                      => "27"
    pub reveal                            => "28"
    pub not_crossed_out                   => "29"
    pub black                             => "30"
    pub red                               => "31"
    pub green                             => "32"
    pub yellow                            => "33"
    pub blue                              => "34"
    pub purple                            => "35"
    pub cyan                              => "36"
    pub white                             => "37"
    pub set_forground_color               => "38"  // next arguments are 5;n or 2;r;g;b
    pub regular_color                     => "39"
    pub background_black                  => "40"
    pub background_red                    => "41"
    pub background_green                  => "42"
    pub background_yellow                 => "43"
    pub background_blue                   => "44"
    pub background_purple                 => "45"
    pub background_cyan                   => "46"
    pub background_white                  => "47"
    pub set_background_set_color          => "48"  // next arguments are 5;n or 2;r;g;b
    pub background_regular_color          => "49"
    pub disable_proprotional_spacing      => "50"
    pub framed                            => "51"
    pub encircled                         => "52"
    pub overlined                         => "53"
    pub neither_framed_nor_encircled      => "54"
    pub not_overlined                     => "55"
    # 57
    # 56
    pub set_underline_color               => "58"  // next arguments are 5;n or 2;r;g;b
    pub default_underline_color           => "59"
    pub ideogram_underline                => "60"
    pub ideogram_double_underline         => "61"
    pub ideogram_overline                 => "62"
    pub ideogram_double_overline          => "63"
    pub ideogram_stress_marking           => "64"
    pub no_ideogram_attributes            => "65"
    # 66..72
    pub superscript                       => "73"
    pub subscript                         => "74"
    pub neither_superscript_nor_subscript => "75"
    # 76..89
    pub bright_black                      => "90"
    pub bright_red                        => "91"
    pub bright_green                      => "92"
    pub bright_yellow                     => "93"
    pub bright_blue                       => "94"
    pub bright_purple                     => "95"
    pub bright_cyan                       => "96"
    pub bright_white                      => "97"
    # 98
    # 99
    pub background_bright_black           => "100"
    pub background_bright_red             => "101"
    pub background_bright_green           => "102"
    pub background_bright_yellow          => "103"
    pub background_bright_blue            => "104"
    pub background_bright_purple          => "105"
    pub background_bright_cyan            => "106"
    pub background_bright_white           => "107"

  pub reset                             => csi + raw.reset + "m"
  pub bold                              => csi + raw.bold + "m"
  pub dime                              => csi + raw.dime + "m"
  pub italic                            => csi + raw.italic + "m"
  pub underline                         => csi + raw.underline + "m"
  pub slow_blink                        => csi + raw.slow_blink + "m"
  pub rapid_blink                       => csi + raw.rapid_blink + "m"
  pub reverse                           => csi + raw.reverse + "m"
  pub crossed_out                       => csi + raw.crossed_out + "m"
  pub font_0                            => csi + raw.font_0 + "m"
  pub font_1                            => csi + raw.font_1 + "m"
  pub font_2                            => csi + raw.font_2 + "m"
  pub font_3                            => csi + raw.font_3 + "m"
  pub font_4                            => csi + raw.font_4 + "m"
  pub font_5                            => csi + raw.font_5 + "m"
  pub font_6                            => csi + raw.font_6 + "m"
  pub font_7                            => csi + raw.font_7 + "m"
  pub font_8                            => csi + raw.font_8 + "m"
  pub font_9                            => csi + raw.font_9 + "m"
  pub fraktur                           => csi + raw.fraktur + "m"
  pub double_underline                  => csi + raw.double_underline + "m"
  pub normal_intensity                  => csi + raw.normal_intensity + "m"
  pub neither_italic_nor_blackletter    => csi + raw.neither_italic_nor_blackletter + "m"
  pub not_underlined                    => csi + raw.not_underlined + "m"
  pub not_blinking                      => csi + raw.not_blinking + "m"
  pub proportional_spacing              => csi + raw.proportional_spacing + "m"
  pub not_reversed                      => csi + raw.not_reversed + "m"
  pub reveal                            => csi + raw.reveal + "m"
  pub not_crossed_out                   => csi + raw.not_crossed_out + "m"
  pub black                             => csi + raw.black + "m"
  pub red                               => csi + raw.red + "m"
  pub green                             => csi + raw.green + "m"
  pub yellow                            => csi + raw.yellow + "m"
  pub blue                              => csi + raw.blue + "m"
  pub purple                            => csi + raw.purple + "m"
  pub cyan                              => csi + raw.cyan + "m"
  pub white                             => csi + raw.white + "m"
  pub set_forground_color               => csi + raw.set_forground_color + "m"
  pub regular_color                     => csi + raw.regular_color + "m"
  pub background_black                  => csi + raw.background_black + "m"
  pub background_red                    => csi + raw.background_red + "m"
  pub background_green                  => csi + raw.background_green + "m"
  pub background_yellow                 => csi + raw.background_yellow + "m"
  pub background_blue                   => csi + raw.background_blue + "m"
  pub background_purple                 => csi + raw.background_purple + "m"
  pub background_cyan                   => csi + raw.background_cyan + "m"
  pub background_white                  => csi + raw.background_white + "m"
  pub set_background_set_color          => csi + raw.set_background_set_color + "m"
  pub background_regular_color          => csi + raw.background_regular_color + "m"
  pub disable_proprotional_spacing      => csi + raw.disable_proprotional_spacing + "m"
  pub framed                            => csi + raw.framed + "m"
  pub encircled                         => csi + raw.encircled + "m"
  pub overlined                         => csi + raw.overlined + "m"
  pub neither_framed_nor_encircled      => csi + raw.neither_framed_nor_encircled + "m"
  pub not_overlined                     => csi + raw.not_overlined + "m"
  # 57
  # 56
  pub set_underline_color               => csi + raw.set_underline_color + "m"
  pub default_underline_color           => csi + raw.default_underline_color + "m"
  pub ideogram_underline                => csi + raw.ideogram_underline + "m"
  pub ideogram_double_underline         => csi + raw.ideogram_double_underline + "m"
  pub ideogram_overline                 => csi + raw.ideogram_overline + "m"
  pub ideogram_double_overline          => csi + raw.ideogram_double_overline + "m"
  pub ideogram_stress_marking           => csi + raw.ideogram_stress_marking + "m"
  pub no_ideogram_attributes            => csi + raw.no_ideogram_attributes + "m"
  # 66..72
  pub superscript                       => csi + raw.superscript + "m"
  pub subscript                         => csi + raw.subscript + "m"
  pub neither_superscript_nor_subscript => csi + raw.neither_superscript_nor_subscript + "m"
  # 76..89
  pub bright_black                      => csi + raw.bright_black + "m"
  pub bright_red                        => csi + raw.bright_red + "m"
  pub bright_green                      => csi + raw.bright_green + "m"
  pub bright_yellow                     => csi + raw.bright_yellow + "m"
  pub bright_blue                       => csi + raw.bright_blue + "m"
  pub bright_purple                     => csi + raw.bright_purple + "m"
  pub bright_cyan                       => csi + raw.bright_cyan + "m"
  pub bright_white                      => csi + raw.bright_white + "m"
  # 98
  # 99
  pub background_bright_black           => csi + raw.background_bright_black + "m"
  pub background_bright_red             => csi + raw.background_bright_red + "m"
  pub background_bright_green           => csi + raw.background_bright_green + "m"
  pub background_bright_yellow          => csi + raw.background_bright_yellow + "m"
  pub background_bright_blue            => csi + raw.background_bright_blue + "m"
  pub background_bright_purple          => csi + raw.background_bright_purple + "m"
  pub background_bright_cyan            => csi + raw.background_bright_cyan + "m"
  pub background_bright_white           => csi + raw.background_bright_white + "m"

pub String.bold                              => terminal.bold + String.this + terminal.reset
pub String.dime                              => terminal.dime + String.this + terminal.reset
pub String.italic                            => terminal.italic + String.this + terminal.reset
pub String.underline                         => terminal.underline + String.this + terminal.reset
pub String.slow_blink                        => terminal.slow_blink + String.this + terminal.reset
pub String.rapid_blink                       => terminal.rapid_blink + String.this + terminal.reset
# NYI: string.reverse causes a conflict with Const_String.reverse since visibility is not supported
# pub string.reverse                           => terminal.reverse + string.this + terminal.reset
pub String.crossed_out                       => terminal.crossed_out + String.this + terminal.reset
pub String.font_0                            => terminal.font_0 + String.this + terminal.reset
pub String.font_1                            => terminal.font_1 + String.this + terminal.reset
pub String.font_2                            => terminal.font_2 + String.this + terminal.reset
pub String.font_3                            => terminal.font_3 + String.this + terminal.reset
pub String.font_4                            => terminal.font_4 + String.this + terminal.reset
pub String.font_5                            => terminal.font_5 + String.this + terminal.reset
pub String.font_6                            => terminal.font_6 + String.this + terminal.reset
pub String.font_7                            => terminal.font_7 + String.this + terminal.reset
pub String.font_8                            => terminal.font_8 + String.this + terminal.reset
pub String.font_9                            => terminal.font_9 + String.this + terminal.reset
pub String.fraktur                           => terminal.fraktur + String.this + terminal.reset
pub String.double_underline                  => terminal.double_underline + String.this + terminal.reset
pub String.normal_intensity                  => terminal.normal_intensity + String.this + terminal.reset
pub String.neither_italic_nor_blackletter    => terminal.neither_italic_nor_blackletter + String.this + terminal.reset
pub String.not_underlined                    => terminal.not_underlined + String.this + terminal.reset
pub String.not_blinking                      => terminal.not_blinking + String.this + terminal.reset
pub String.proportional_spacing              => terminal.proportional_spacing + String.this + terminal.reset
pub String.not_reversed                      => terminal.not_reversed + String.this + terminal.reset
pub String.reveal                            => terminal.reveal + String.this + terminal.reset
pub String.not_crossed_out                   => terminal.not_crossed_out + String.this + terminal.reset
pub String.black                             => terminal.black + String.this + terminal.reset
pub String.red                               => terminal.red + String.this + terminal.reset
pub String.green                             => terminal.green + String.this + terminal.reset
pub String.yellow                            => terminal.yellow + String.this + terminal.reset
pub String.blue                              => terminal.blue + String.this + terminal.reset
pub String.purple                            => terminal.purple + String.this + terminal.reset
pub String.cyan                              => terminal.cyan + String.this + terminal.reset
pub String.white                             => terminal.white + String.this + terminal.reset
pub String.set_forground_color               => terminal.set_forground_color + String.this + terminal.reset
pub String.regular_color                     => terminal.regular_color + String.this + terminal.reset
pub String.background_black                  => terminal.background_black + String.this + terminal.reset
pub String.background_red                    => terminal.background_red + String.this + terminal.reset
pub String.background_green                  => terminal.background_green + String.this + terminal.reset
pub String.background_yellow                 => terminal.background_yellow + String.this + terminal.reset
pub String.background_blue                   => terminal.background_blue + String.this + terminal.reset
pub String.background_purple                 => terminal.background_purple + String.this + terminal.reset
pub String.background_cyan                   => terminal.background_cyan + String.this + terminal.reset
pub String.background_white                  => terminal.background_white + String.this + terminal.reset
pub String.set_background_set_color          => terminal.set_background_set_color + String.this + terminal.reset
pub String.background_regular_color          => terminal.background_regular_color + String.this + terminal.reset
pub String.disable_proprotional_spacing      => terminal.disable_proprotional_spacing + String.this + terminal.reset
pub String.framed                            => terminal.framed + String.this + terminal.reset
pub String.encircled                         => terminal.encircled + String.this + terminal.reset
pub String.overlined                         => terminal.overlined + String.this + terminal.reset
pub String.neither_framed_nor_encircled      => terminal.neither_framed_nor_encircled + String.this + terminal.reset
pub String.not_overlined                     => terminal.not_overlined + String.this + terminal.reset
# 57
# 56
pub String.set_underline_color               => terminal.set_underline_color + String.this + terminal.reset
pub String.default_underline_color           => terminal.default_underline_color + String.this + terminal.reset
pub String.ideogram_underline                => terminal.ideogram_underline + String.this + terminal.reset
pub String.ideogram_double_underline         => terminal.ideogram_double_underline + String.this + terminal.reset
pub String.ideogram_overline                 => terminal.ideogram_overline + String.this + terminal.reset
pub String.ideogram_double_overline          => terminal.ideogram_double_overline + String.this + terminal.reset
pub String.ideogram_stress_marking           => terminal.ideogram_stress_marking + String.this + terminal.reset
pub String.no_ideogram_attributes            => terminal.no_ideogram_attributes + String.this + terminal.reset
# 66..72
pub String.superscript                       => terminal.superscript + String.this + terminal.reset
pub String.subscript                         => terminal.subscript + String.this + terminal.reset
pub String.neither_superscript_nor_subscript => terminal.neither_superscript_nor_subscript + String.this + terminal.reset
  # 76..89
pub String.bright_black                      => terminal.bright_black + String.this + terminal.reset
pub String.bright_red                        => terminal.bright_red + String.this + terminal.reset
pub String.bright_green                      => terminal.bright_green + String.this + terminal.reset
pub String.bright_yellow                     => terminal.bright_yellow + String.this + terminal.reset
pub String.bright_blue                       => terminal.bright_blue + String.this + terminal.reset
pub String.bright_purple                     => terminal.bright_purple + String.this + terminal.reset
pub String.bright_cyan                       => terminal.bright_cyan + String.this + terminal.reset
pub String.bright_white                      => terminal.bright_white + String.this + terminal.reset
  # 98
  # 99
pub String.background_bright_black           => terminal.background_bright_black + String.this + terminal.reset
pub String.background_bright_red             => terminal.background_bright_red + String.this + terminal.reset
pub String.background_bright_green           => terminal.background_bright_green + String.this + terminal.reset
pub String.background_bright_yellow          => terminal.background_bright_yellow + String.this + terminal.reset
pub String.background_bright_blue            => terminal.background_bright_blue + String.this + terminal.reset
pub String.background_bright_purple          => terminal.background_bright_purple + String.this + terminal.reset
pub String.background_bright_cyan            => terminal.background_bright_cyan + String.this + terminal.reset
pub String.background_bright_white           => terminal.background_bright_white + String.this + terminal.reset

# end of file
